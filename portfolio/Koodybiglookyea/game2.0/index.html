<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Neon Defender Pro</title>
    <style>
        :root { --neon: #00f2ff; --bg: #050505; }
        body { margin: 0; background: var(--bg); color: white; font-family: 'Courier New', monospace; display: flex; flex-direction: column; align-items: center; overflow-x: hidden; }
        
        /* Layout */
        nav { width: 100%; padding: 15px; background: #111; border-bottom: 2px solid var(--neon); text-align: center; color: var(--neon); box-shadow: 0 0 20px rgba(0,242,255,0.2); }
        .wrapper { display: flex; gap: 20px; padding: 20px; max-width: 1200px; width: 100%; }
        
        /* Game Container */
        #game-container { position: relative; border: 3px solid #333; border-radius: 10px; overflow: hidden; flex: 2; }
        canvas { display: block; background: radial-gradient(circle, #111 0%, #000 100%); width: 100%; height: auto; }
        
        /* UI Overlays */
        .overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; background: rgba(0,0,0,0.85); transition: 0.5s; }
        .hidden { display: none; }
        
        /* Sidebar */
        .sidebar { flex: 1; background: #111; padding: 20px; border-radius: 10px; border: 1px solid #333; }
        .stat { font-size: 1.2rem; margin-bottom: 10px; border-bottom: 1px solid #222; padding-bottom: 5px; }
        .stat span { color: var(--neon); float: right; }
        
        button { background: transparent; border: 2px solid var(--neon); color: var(--neon); padding: 15px 30px; font-size: 1.2rem; cursor: pointer; transition: 0.3s; font-family: inherit; }
        button:hover { background: var(--neon); color: black; box-shadow: 0 0 20px var(--neon); }
    </style>
</head>
<body>

<nav><h1>// NEON_DEFENDER_v2.0</h1></nav>

<div class="wrapper">
    <div id="game-container">
        <canvas id="gameCanvas" width="800" height="500"></canvas>
        
        <div id="startScreen" class="overlay">
            <h1 style="color:var(--neon); font-size: 3rem;">READY?</h1>
            <p>High Score: <span id="hiScoreLabel">0</span></p>
            <button onclick="startGame()">INITIALIZE MISSION</button>
        </div>
    </div>

    <div class="sidebar">
        <div class="stat">SCORE <span id="s_score">0</span></div>
        <div class="stat">HEALTH <span id="s_health">100%</span></div>
        <div class="stat">WAVE <span id="s_wave">1</span></div>
        <div class="stat">BEST <span id="s_best">0</span></div>
        
        <div style="margin-top: 40px; color: #666; font-size: 0.8rem;">
            [MOUSE] Move & Shoot<br>
            [P] Pause Game<br><br>
            TIP: Yellow blocks give Triple Shot power!
        </div>
    </div>
</div>

<script>
/** ENGINE SCRIPT **/
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const startScreen = document.getElementById("startScreen");

// Game State
let gameState = 'START';
let score = 0;
let health = 100;
let wave = 1;
let hiScore = localStorage.getItem('neonHiScore') || 0;
document.getElementById('s_best').innerText = hiScore;
document.getElementById('hiScoreLabel').innerText = hiScore;

// Entities
let player = { x: 400, y: 450, w: 40, h: 20, power: 0 };
let bullets = [];
let enemies = [];
let particles = [];
let powerups = [];

// Input
let mouseX = 400;
canvas.addEventListener('mousemove', e => {
    const rect = canvas.getBoundingClientRect();
    mouseX = (e.clientX - rect.left) * (canvas.width / rect.width);
});
canvas.addEventListener('mousedown', () => { if(gameState === 'PLAY') fire(); });

function fire() {
    if (player.power > 0) {
        bullets.push({x: player.x - 15, y: player.y, v: -10}, {x: player.x, y: player.y, v: -10}, {x: player.x + 15, y: player.y, v: -10});
        player.power--;
    } else {
        bullets.push({x: player.x, y: player.y, v: -10});
    }
}

function createExplosion(x, y, color) {
    for(let i=0; i<8; i++) {
        particles.push({x, y, vx: (Math.random()-0.5)*10, vy: (Math.random()-0.5)*10, life: 1, color});
    }
}

function spawn() {
    if (Math.random() < 0.02 + (wave * 0.005)) {
        let isPower = Math.random() < 0.05;
        enemies.push({
            x: Math.random() * (canvas.width - 30),
            y: -30,
            w: isPower ? 20 : 30,
            h: isPower ? 20 : 30,
            hp: isPower ? 1 : Math.ceil(wave/2),
            type: isPower ? 'power' : 'enemy',
            speed: 2 + Math.random() * wave
        });
    }
}

function update() {
    if (gameState !== 'PLAY') return;

    player.x += (mouseX - player.x) * 0.2; // Smooth following

    bullets.forEach((b, i) => {
        b.y += b.v;
        if (b.y < 0) bullets.splice(i, 1);
    });

    enemies.forEach((en, i) => {
        en.y += en.speed;
        
        // Check Collision with Bullets
        bullets.forEach((b, bi) => {
            if (b.x > en.x && b.x < en.x + en.w && b.y < en.y + en.h && b.y > en.y) {
                en.hp--;
                bullets.splice(bi, 1);
                if (en.hp <= 0) {
                    if (en.type === 'power') player.power += 15;
                    createExplosion(en.x, en.y, en.type === 'power' ? '#ff0' : '#0ff');
                    enemies.splice(i, 1);
                    score += 10;
                    if (score % 200 === 0) wave++;
                }
            }
        });

        if (en.y > canvas.height) {
            enemies.splice(i, 1);
            health -= 10;
        }
    });

    particles.forEach((p, i) => {
        p.x += p.vx; p.y += p.vy; p.life -= 0.02;
        if (p.life <= 0) particles.splice(i, 1);
    });

    if (health <= 0) endGame();
    spawn();
    
    // UI Update
    document.getElementById('s_score').innerText = score;
    document.getElementById('s_health').innerText = health + "%";
    document.getElementById('s_wave').innerText = wave;
}

function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Draw Player
    ctx.fillStyle = player.power > 0 ? '#ff0' : '#0f0';
    ctx.fillRect(player.x - player.w/2, player.y, player.w, player.h);
    
    // Draw Entities
    bullets.forEach(b => { ctx.fillStyle = 'white'; ctx.fillRect(b.x-2, b.y, 4, 10); });
    enemies.forEach(en => { 
        ctx.fillStyle = en.type === 'power' ? '#ff0' : '#f05';
        ctx.fillRect(en.x, en.y, en.w, en.h); 
    });
    particles.forEach(p => {
        ctx.globalAlpha = p.life;
        ctx.fillStyle = p.color;
        ctx.fillRect(p.x, p.y, 3, 3);
    });
    ctx.globalAlpha = 1;

    requestAnimationFrame(update);
    requestAnimationFrame(draw);
}

function startGame() {
    gameState = 'PLAY';
    health = 100; score = 0; wave = 1; enemies = [];
    startScreen.classList.add('hidden');
}

function endGame() {
    gameState = 'START';
    if (score > hiScore) {
        hiScore = score;
        localStorage.setItem('neonHiScore', hiScore);
    }
    document.getElementById('hiScoreLabel').innerText = hiScore;
    document.getElementById('s_best').innerText = hiScore;
    startScreen.classList.remove('hidden');
}

draw();
</script>
</body>
</html>